---
title: Upgrading a PEM Installation on Windows host
metaTitle: Upgrading a PEM Installation on Windows host
metaDescription: description
---

To upgrade PEM component software on Windows hosts, simply invoke a
newer version of the PEM component installers in the following order:

1.  Invoke the PEM agent installer on each monitored node *except* the
    PEM server node.
2.  Invoke the PEM server installer; this installer will upgrade *both*
    the PEM server and the PEM agent that resides on the PEM server
    node.

During an installation, the component installer will automatically
detect an existing installation, and perform an upgrade. After upgrading
the PEM agent and server, you should upgrade SQL Profiler; this step is
platform-specific.

The following sections will walk you through the upgrade process on a
Windows host, step-by-step.

## Upgrading a PEM Agent on Windows host

To upgrade a system that is currently monitored by a PEM agent to a
more-recent version of PEM agent, simply download and invoke a newer
version of the platform-specific PEM agent installer on the system that
the agent is monitoring.

You can invoke the installer by right-clicking on the downloaded
installer's icon, and selecting `Run as Administrator`. The `PEM Agent
Setup Wizard` opens, welcoming you.

![*The PEM Agent installer welcome
window*](images/pem_upgrade_agent_welcome.png)

Read and accept the `License Agreement` before clicking `Next` to
continue.

![*The PEM license agreement*](images/pem_upgrade_agent_license.png)

The setup wizard will automatically detect an existing agent, and
upgrade the installed version. Click `Next` to continue.

![*The installer detects an existing
installation*](images/pem_upgrade_agent_existing_installation.png)

When the `Ready to Install` dialog informs you that the installation is
about to begin, click `Next` to continue.

![*The PEM Agent will perform the
upgrade*](images/pem_upgrade_agent_ready_install.png)

The setup wizard displays progress bars to inform you of each component
that is being installed.

![*The PEM Agent will perform the
upgrade*](images/pem_upgrade_agent_installing.png)

The `PEM Agent Setup Wizard` will inform you when the installation
completes. Click `Finish` to exit the wizard and close the window.

![*The PEM Agent Setup Wizard has finished the
update*](images/pem_upgrade_agent_finish.png)

## Upgrading the PEM Server on a Windows host

The PEM server installer facilitates upgrading directly between major
versions of the PEM server (for example, you can upgrade directly from
version 5.0 to version 7.5 without first upgrading to version 6.0).

You can invoke the installer by right-clicking on the downloaded
installer's icon, and selecting `Run as Administrator`.

![*The PEM Server Setup Wizard*](images/pem_upgrade_server_welcome.png)

The `PEM Server Setup Wizard` welcomes you, as shown in the image. Click
`Next` to continue to the `License Agreement`.

The `PEM server setup wizard` will prompt you to accept the `License
Agreement`. After reviewing the license agreement, check the radio
button next to `I accept the agreement`, and click `Next` to continue to
the `Existing installation dialog`.

![*Accept the License Agreement to
continue*](images/pem_upgrade_server_license.png)

The wizard will check the PEM server host for an existing PEM server
installation; if the wizard locates an installation, it will perform an
upgrade. Click `Next` to continue.

![*The PEM server installer detects an existing PEM server
Installation*](images/pem_upgrade_server_existing_installation.png)

Before upgrading the PEM server, the wizard will confirm that the
requirements of the new PEM server are present. If any supporting
components are missing, or are a version that will not support the new
PEM installation, the PEM installation wizard will inform you that it
must upgrade the dependencies, and will invoke the required installers.

![*The installation requires dependency
upgrades*](images/pem_upgrade_server_dependency_missing.png)

When the installation wizards complete the dependency upgrades, focus
will return to the PEM server setup wizard.

The wizard then opens the `Database Server Installation Details` dialog,
prompting you for connection credentials for database superuser of the
PEM backing database. Provide:

  - The name of the database superuser in the `User` field.
  - The password associated with the database superuser in the
    `Password` field.

Click `Next` to continue.

![*Provide connection information for the backing
database*](images/pem_upgrade_server_DB_installation.png)

The `pemAgent service account` dialog may prompt you for the password of
the account under which the PEM agent service runs.

![*pemAgent Service Account
password*](images/pem_upgrade_server_pemAgent_service_account.png)

If prompted, provide the password, and click `Next` to continue.

![*The PEM Setup Wizard is ready to install the PEM
server*](images/pem_upgrade_server_ready_install.png)

The `Ready to Install` dialog will inform you that the setup wizard is
ready to perform the installation. Click `Next` to start the
installation.

During the installation, progress bars will keep you informed of the
progress of the update.

![*The PEM Server installation in
progress*](images/pem_upgrade_server_installing.png)

After updating the PEM server (and the agent that resides on the same
host as the PEM server) and configuring the webservice, the PEM setup
wizard notifies you of the port on which the service is listening. Use
this port number when connecting to the PEM Server with the PEM client.

![*The setup wizard configures the PEM
webservice*](images/pem_upgrade_server_webservice_configure.png)

Click `OK` to close the `Info` popup. The PEM server setup wizard
informs you that the installation is complete.

![*The PEM Server upgrade is
complete*](images/pem_upgrade_server_finish.png)

If you have installed the PEM backend database server and PEM-HTTPD on
different hosts, then you must run the PEM server installer twice â€“ once
on each host. Extract the language pack installer, and install it on the
host of PEM-HTTPD before invoking the PEM installer. Include the
following keywords when invoking the installer to extract the language
pack:

> `--extract-languagepack <path>`

Where `<path>` specifies an existing path for extracting the language
pack installer.

<div class="note">

<div class="title">

Note

</div>

By default EDB Languagepack is installed in `C:\edb\languagepack\v1`.

</div>

If you are upgrading the PEM Server via StackBuilder Plus then you might
face the error shown below; after displaying the error, PEM will say
that installation is completed. Please note that the installation is not
done and you will need to do the installation by invoking the installer
file from the location where it is downloaded.

![*The PEM Server upgrade error*](images/pem_upgrade_server_error.png)

After upgrading the PEM server, you may wish to upgrade the backing
database to a more recent version; for information about upgrading the
backing database, see [Upgrading the backing
database](upgrading_backing_database).

## Upgrading SQL Profiler on Windows host

If you are using SQL Profiler on a Windows host, Windows will lock any
files that have been executed or loaded into memory. To release any
locked files, you must stop the Postgres server before performing an
upgrade.

On Windows, you can use the `Services` dialog to control the service. To
open the `Services` dialog, navigate through the `Control Panel` to the
`System and Security menu`. Select `Administrative Tools`, and then
double-click the `Services` icon. When the `Services` dialog opens,
highlight the service name in the list, and use the option provided on
the dialog to `Stop` the service.

After stopping the Postgres Server:

1.  Delete the existing SQL Profiler query set on each node by invoking
    the `uninstall-sql-profiler.sql` script.
    
    By default, the script resides in the `share\contrib` directory
    under your Advanced Server or PostgreSQL installation.

2.  Invoke the new SQL Profiler installer on each node you wish to
    profile.

Then, restart the Postgres Server, to resume profiling the node from a
PEM client. After updating the PEM components, you are ready to update
the backing database.
