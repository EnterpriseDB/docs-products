---
title: "The Cluster Properties File"
---

Each node in a Failover Manager cluster has a properties file (by default, named `efm.properties`) that contains the properties of the individual node on which it resides. The Failover Manager installer creates a file template for the properties file named `efm.properties.in` in the `/etc/edb/efm-3.9` directory.

After completing the Failover Manager installation, you must make a working copy of the template before modifying the file contents:

> `# cp /etc/edb/efm-3.9/efm.properties.in /etc/edb/efm-3.9/efm.properties`

After copying the template file, change the owner of the file to `efm`:

> `# chown efm:efm efm.properties`

Please note: By default, Failover Manager expects the cluster properties file to be named `efm.properties`. If you name the properties file something other than `efm.properties`, you must modify the service script or unit file to instruct Failover Manager to use a different name.

After creating the cluster properties file, add (or modify) configuration parameter values as required. For detailed information about each property, see [Specifying Cluster Properties](specifying_cluster_properties).

The property files are owned by `root`. The Failover Manager service script expects to find the files in the `/etc/edb/efm-3.9 directory`. If you move the property file to another location, you must create a symbolic link that specifies the new location.

Please note that all user scripts referenced in the properties file will be invoked as the Failover Manager user.

## Specifying Cluster Properties

You can use the properties listed in the cluster properties file to specify connection properties and behaviors for your Failover Manager cluster. Modifications to property settings will be applied when Failover Manager starts. If you modify a property value you must restart Failover Manager to apply the changes.

Property values are case-sensitive. Note that while Postgres uses quoted strings in parameter values, Failover Manager does not allow quoted strings in property values. For example, while you might specify an IP address in a Postgres configuration parameter as:

> `listen_addresses='192.168.2.47'`

Failover Manager requires that the value *not* be enclosed in quotes:

> `bind.address=192.168.2.54:7800`

Use the properties in the `efm.properties` file to specify connection, administrative, and operational details for Failover Manager.

<div class="index">

db.user db.password.encrypted db.port db.database

</div>

Use the following properties to specify connection details for the Failover Manager cluster:

``` text
---
title: "The value for the password property should be the output from"
---
---
title: "'efm encrypt' -- do not include a cleartext password here. To"
---
---
title: "prevent accidental sharing of passwords among clusters, the"
---
---
title: "cluster name is incorporated into the encrypted password. If"
---
---
title: "you change the cluster name (the name of this file), you must"
---
---
title: "encrypt the password again with the new name."
---
---
title: "The db.port property must be the same for all nodes."
---
db.user=
db.password.encrypted=
db.port=
db.database=
```

The `db.user` specified must have sufficient privileges to invoke selected PostgreSQL commands on behalf of Failover Manager. For more information, please see `Prerequisites <prerequisites>`.

For information about encrypting the password for the database user, see `Encrypting Your Database Password <encrypting_database_password>`.

<div class="index">

db.service.owner

</div>

Use the `db.service.owner` property to specify the name of the operating system user that owns the cluster that is being managed by Failover Manager. This property is not required on a dedicated witness node.

``` text
---
title: "This property tells EFM which OS user owns the $PGDATA dir for"
---
---
title: "the 'db.database'. By default, the owner is either 'postgres'"
---
---
title: "for PostgreSQL or 'enterprisedb' for EDB Postgres Advanced"
---
---
title: "Server. However, if you have configured your db to run as a"
---
---
title: "different user, you will need to copy the /etc/sudoers.d/efm-XX"
---
---
title: "conf file to grant the necessary permissions to your db owner."
---
#
---
title: "This username must have write permission to the"
---
---
title: "'db.data.dir' specified below."
---
db.service.owner=
```

<div class="index">

db.service.name

</div>

Specify the name of the database service in the `db.service.name` property if you use the service or systemctl command when starting or stopping the service.

``` text
---
title: "Specify the proper service name in order to use service commands rather"
---
---
title: "than pg_ctl to start/stop/restart a database. For example, if this property"
---
---
title: "is set, then 'service <name> restart' or 'systemctl restart <name>'"
---
---
title: "(depending on OS version) will be used to restart the database rather than pg_ctl."
---
---
title: "This property is required if running the database as a service."
---
db.service.name=
```

You should use the same service control mechanism (pg_ctl, service, or systemctl) each time you start or stop the database service. If you use the `pg_ctl` program to control the service, specify the location of the `pg_ctl` program in the `db.bin` property.

``` text
---
title: "Specify the directory containing the pg_controldata/pg_ctl commands, for example:"
---
---
title: "/usr/edb/as11/bin. Unless the db.service.name property is used, the pg_ctl"
---
---
title: "command is used to start/stop/restart databases as needed after a"
---
---
title: "failover or switchover. This property is required."
---
db.bin=
```

<div class="index">

db.data.dir

</div>

Use the `db.data.dir` property to specify the location to which a recovery file will be written on the Master node of the cluster, and a trigger file is written on a Standby. This property required on master and standby nodes; it is not required on a dedicated witness node.

``` text
---
title: "For database version 12 and up, this is the directory where a standby.signal"
---
---
title: "file will exist for a standby node. For previous versions, this is the"
---
---
title: "location of the db recovery.conf file on the node. "
---
---
title: "After a failover, the recovery.conf files on remaining standbys are changed"
---
---
title: "to point to the new master db (a copy of the original is made first). On a"
---
---
title: "master node, a recovery.conf file will be written during failover and"
---
---
title: "promotion to ensure that the master node can not be restarted as the"
---
---
title: "master database."
---
---
title: "This corresponds to database environment variable PGDATA and should be same"
---
---
title: "as the output of query 'show data_directory;' on respective database."
---
db.data.dir=
```

<div class="index">

db.config.dir

</div>

Use the `db.config.dir` property to specify the location of database configuration files if they are not stored in the same directory as the `recovery.conf` or `standby.signal` file. This should be the value specified by the `config_file` parameter directory of your Advanced Server or PostgreSQL installation. This value will be used as the location of the Postgres `data` directory when stopping, starting, or restarting the database.

``` text
---
title: "Specify the location of database configuration files if they are not contained"
---
---
title: "in the same location as the recovery.conf or standby.signal file. This is most"
---
---
title: "likely the case for Debian installations. The location specified will be used as"
---
---
title: "the -D value (the location of the data directory for the cluster)"
---
---
title: "when calling pg_ctl to start or stop the database. If this property is blank,"
---
---
title: "the db.data.dir location specified by the db.data.dir property will be used."
---
---
title: "This corresponds to the output of query 'show config_file;' on respective database."
---
db.config.dir=
```

For more information about database configuration files, visit the [PostgreSQL website](https://www.postgresql.org/docs/12/runtime-config-file-locations.html)

Use the `jdbc.sslmode` property to instruct Failover Manager to use SSL connections; by default, SSL is disabled.

``` text
---
title: "Use the jdbc.sslmode property to enable ssl for EFM"
---
---
title: "connections. Setting this property to anything but 'disable'"
---
---
title: "will force the agents to use 'ssl=true' for all JDBC database"
---
---
title: "connections (to both local and remote databases)."
---
---
title: "Valid values are:"
---
#
---
title: "disable - Do not use ssl for connections."
---
---
title: "verify-ca - EFM will perform CA verification before allowing"
---
---
title: "the certificate."
---
---
title: "require - Verification will not be performed on the server"
---
---
title: "certificate."
---
jdbc.sslmode=disable
```

For information about configuring and using SSL, please see:

<https://www.postgresql.org/docs/12/static/ssl-tcp.html>

and

<https://jdbc.postgresql.org/documentation/head/ssl.html>

<div class="index">

user.email

</div>

Use the `user.email` property to specify an email address (or multiple email addresses) that will receive any notifications sent by Failover Manager.

``` text
---
title: "Email address(es) for notifications. The value of this"
---
---
title: "property must be the same across all agents. Multiple email"
---
---
title: "addresses must be separated by space. If using a notification"
---
---
title: "script instead, this property can be left blank."
---
user.email=
```

The `from.email` property specifies the value that will be used as the sender's address on any email notifications from Failover Manager. You can:

  - leave `from.email` blank to use the default value (`efm@localhost`).
  - specify a custom value for the email address.
  - specify a custom email address, using the `%h` placeholder to represent the name of the node host (e.g., <example@%h>). The placeholder will be replaced with the name of the host as returned by the Linux hostname utility.

For more information about notifications, see `Notifications <notifications>` .

``` text
---
title: "Use the from.email property to specify the from email address that"
---
---
title: "will be used for email notifications. Use the %h placeholder to"
---
---
title: "represent the name of the node host (e.g. example@%h). The"
---
---
title: "placeholder will be replaced with the name of the host as returned"
---
---
title: "by the hostname command."
---
---
title: "Leave blank to use the default, efm@localhost."
---
from.email=
```

Use the `notification.level` property to specify the minimum severity level at which Failover Manager will send user notifications or when a notification script is called. For a complete list of notifications, please see `Notifications <notifications>`.

``` text
---
title: "Minimum severity level of notifications that will be sent by"
---
---
title: "the agent. The minimum level also applies to the notification"
---
---
title: "script (below). Valid values are INFO, WARNING, and SEVERE."
---
---
title: "A list of notifications is grouped by severity in the user's"
---
---
title: "guide."
---
notification.level=INFO
```

<div class="index">

script.notification.property

</div>

Use the `script.notification` property to specify the path to a user-supplied script that acts as a notification service; the script will be passed a message subject and a message body. The script will be invoked each time Failover Manager generates a user notification.

``` text
---
title: "Absolute path to script run for user notifications."
---
#
---
title: "This is an optional user-supplied script that can be used for"
---
---
title: "notifications instead of email. This is required if not using"
---
---
title: "email notifications. Either/both can be used. The script will"
---
---
title: "be passed two parameters: the message subject and the message"
---
---
title: "body."
---
script.notification=
```

<div class="index">

bind.address

</div>

The `bind.address` property specifies the IP address and port number of the agent on the current node of the Failover Manager cluster.

``` text
---
title: "This property specifies the ip address and port that jgroups"
---
---
title: "will bind to on this node. The value is of the form"
---
---
title: "<ip>:<port>."
---
---
title: "Note that the port specified here is used for communicating"
---
---
title: "with other nodes, and is not the same as the admin.port below,"
---
---
title: "used only to communicate with the local agent to send control"
---
---
title: "signals."
---
---
title: "For example, <provide_your_ip_address_here>:7800"
---
bind.address=
```

<div class="index">

admin.port

</div>

Use the `admin.port` property to specify a port on which Failover Manager listens for administrative commands.

``` text
---
title: "This property controls the port binding of the administration"
---
---
title: "server which is used for some commands (ie cluster-status). The"
---
---
title: "default is 7809; you can modify this value if the port is"
---
---
title: "already in use."
---
admin.port=7809
```

<div class="index">

is.witness

</div>

Set the `is.witness` property to true to indicate that the current node is a witness node. If is.witness is true, the local agent will not check to see if a local database is running.

``` text
---
title: "Specifies whether or not this is a witness node. Witness nodes"
---
---
title: "do not have local databases running."
---
is.witness=
```

The Postgres `pg_is_in_recovery()` function is a boolean function that reports the recovery state of a database. The function returns `true` if the database is in recovery, or false if the database is not in recovery. When an agent starts, it connects to the local database and invokes the `pg_is_in_recovery()` function. If the server responds true, the agent assumes the role of standby; if the server responds false, the agent assumes the role of master. If there is no local database, the agent will assume an idle state.

<div class="note">

<div class="title">

Note

</div>

If `is.witness` is `true`, Failover Manager will not check the recovery state.

</div>

<div class="index">

local.period local.timeout local.timeout.final

</div>

The following properties specify properties that apply to the local server:

  - The `local.period` property specifies how many seconds between attempts to contact the database server.
  - The `local.timeout property` specifies how long an agent will wait for a positive response from the local database server.
  - The `local.timeout.final` property specifies how long an agent will wait after the final attempt to contact the database server on the current node. If a response is not received from the database within the number of seconds specified by the local.timeout.final property, the database is assumed to have failed.

For example, given the default values of these properties, a check of the local database happens once every 10 seconds. If an attempt to contact the local database does not come back positive within 60 seconds, Failover Manager makes a final attempt to contact the database. If a response is not received within 10 seconds, Failover Manager declares database failure and notifies the administrator listed in the user.email property. These properties are not required on a dedicated witness node.

``` text
---
title: "These properties apply to the connection(s) EFM uses to monitor"
---
---
title: "the local database. Every 'local.period' seconds, a database"
---
---
title: "check is made in a background thread. If the main monitoring"
---
---
title: "thread does not see that any checks were successful in"
---
---
title: "'local.timeout' seconds, then the main thread makes a final"
---
---
title: "check with a timeout value specified by the"
---
---
title: "'local.timeout.final' value. All values are in seconds."
---
---
title: "Whether EFM uses single or multiple connections for database"
---
---
title: "checks is controlled by the 'db.reuse.connection.count'"
---
---
title: "property."
---
local.period=10
local.timeout=60
local.timeout.final=10
```

If necessary, you should modify these values to suit your business model.

<div class="index">

remote.timeout

</div>

Use the `remote.timeout` property to specify how many seconds an agent waits for a response from a remote database server (i.e., how long a standby agent waits to verify that the master database is actually down before performing failover).

``` text
---
title: "Timeout for a call to check if a remote database is responsive."
---
---
title: "For example, this is how long a standby would wait for a"
---
---
title: "DB ping request from itself and the witness to the master DB"
---
---
title: "before performing failover."
---
remote.timeout=10
```

<div class="index">

node.timeout

</div>

Use the `node.timeout` property to specify the number of seconds that an agent will wait for a response from a node when determining if a node has failed. The node.timeout property value specifies a timeout value for agent-to-agent communication; other timeout properties in the cluster properties file specify values for agent-to-database communication.

``` text
---
title: "The total amount of time in seconds to wait before determining"
---
---
title: "that a node has failed or been disconnected from this node."
---
#
---
title: "The value of this property must be the same across all agents."
---
node.timeout=50
```

<div class="index">

stop.isolated.master

</div>

Use the `stop.isolated.master` property to instruct Failover Manager to shut down the database if a master agent detects that it is isolated. When true (the default), Failover Manager will stop the database before invoking the script specified in the `script.master.isolated` property.

``` text
---
title: "Shut down the database after a master agent detects that it has"
---
---
title: "been isolated from the majority of the efm cluster. If set to"
---
---
title: "true, efm will stop the database before running the"
---
---
title: "'script.master.isolated' script, if a script is specified."
---
stop.isolated.master=true
```

<div class="index">

stop.failed.master

</div>

Use the `stop.failed.master` property to instruct Failover Manager to attempt to shut down a master database if it can not reach the database. If `true`, Failover Manager will run the script specified in the `script.db.failure` property after attempting to shut down the database.

``` text
---
title: "Attempt to shut down a failed master database after EFM can no"
---
---
title: "longer connect to it. This can be used for added safety in the"
---
---
title: "case a failover is caused by a failure of the network on the"
---
---
title: "master node."
---
---
title: "If specified, a 'script.db.failure' script is run after this attempt."
---
stop.failed.master=true
```

Use the `master.shutdown.as.failure` parameter to indicate that any shutdown of the Failover Manager agent on the master node should be treated as a failure. If this parameter is set to `true` and the master agent stops (for any reason), the cluster will attempt to confirm if the database on the master node is running:

  - If the database is reached, a notification will be sent informing you of the agent status.
  - If the database is not reached, a failover will occur.

<!-- end list -->

``` text
---
title: "Treat a master agent shutdown as a failure. This can be set to"
---
---
title: "true to treat a master agent shutdown as a failure situation,"
---
---
title: "e.g. during the shutdown of a node, accidental or otherwise."
---
---
title: "Caution should be used when using this feature, as it could"
---
---
title: "cause an unwanted promotion in the case of performing master"
---
---
title: "database maintenance."
---
---
title: "Please see the user's guide for more information."
---
master.shutdown.as.failure=false
```

The `master.shutdown.as.failure` property is meant to catch user error, rather than failures such as the accidental shutdown of a master node. The proper shutdown of a node can appear to the rest of the cluster like a user has stopped the master Failover Manager agent (for example to perform maintenance on the master database). If you set the `master.shutdown.as.failure` property to `true`, care must be taken when performing maintenance.

To perform maintenance on the master database when `master.shutdown.as.failure` is `true`, you should stop the master agent and wait to receive a notification that the master agent has failed but the database is still running. Then it is safe to stop the master database. Alternatively, you can use the `efm stop-cluster` command to stop all of the agents without failure checks being performed.

<div class="index">

ping.server.ip

</div>

Use the `ping.server.ip` property to specify the IP address of a server that Failover Manager can use to confirm that network connectivity is not a problem.

``` text
---
title: "This is the address of a well-known server that EFM can ping"
---
---
title: "in an effort to determine network reachability issues. It"
---
---
title: "might be the IP address of a nameserver within your corporate"
---
---
title: "firewall or another server that *should* always be reachable"
---
---
title: "via a 'ping' command from each of the EFM nodes."
---
#
---
title: "There are many reasons why this node might not be considered"
---
---
title: "reachable: firewalls might be blocking the request, ICMP might"
---
---
title: "be filtered out, etc."
---
#
---
title: "Do not use the IP address of any node in the EFM cluster"
---
---
title: "(master, standby, or witness) because this ping server is meant"
---
---
title: "to provide an additional layer of information should the EFM"
---
---
title: "nodes lose sight of each other."
---
#
---
title: "The installation default is Google's DNS server."
---
ping.server.ip=8.8.8.8
```

<div class="index">

ping.server.command

</div>

Use the `ping.server.command` property to specify the command used to test network connectivity.

``` text
---
title: "This command will be used to test the reachability of certain"
---
---
title: "nodes."
---
#
---
title: "Do not include an IP address or hostname on the end of"
---
---
title: "this command - it will be added dynamically at runtime with the"
---
---
title: "values contained in 'virtual.ip' and 'ping.server.ip'."
---
#
---
title: "Make sure this command returns reasonably quickly - test it"
---
---
title: "from a shell command line first to make sure it works properly."
---
ping.server.command=/bin/ping -q -c3 -w5
```

Use the `auto.allow.hosts` property to instruct the server to use the addresses specified in the .nodes file of the first node started to update the allowed host list. Enabling this property (setting auto.allow.hosts to true) can simplify cluster start-up.

``` text
---
title: "Have the first node started automatically add the addresses"
---
---
title: "from its .nodes file to the allowed host list. This will make"
---
---
title: "it faster to start the cluster when the initial set of hosts"
---
---
title: "is already known."
---
auto.allow.hosts=false
```

Use the `stable.nodes.file` property to instruct the server to not rewrite the nodes file when a node joins or leaves the cluster. This property is most useful in clusters with unchanging IP addresses.

``` text
---
title: "When set to true, EFM will not rewrite the .nodes file whenever"
---
---
title: "new nodes join or leave the cluster. This can help starting a"
---
---
title: "cluster in the cases where it is expected for member addresses"
---
---
title: "to be mostly static, and combined with 'auto.allow.hosts' makes"
---
---
title: "startup easier when learning failover manager."
---
stable.nodes.file=false
```

<div class="index">

db.reuse.connection.count

</div>

The `db.reuse.connection.count` property allows the administrator to specify the number of times Failover Manager reuses the same database connection to check the database health. The default value is 0, indicating that Failover Manager will create a fresh connection each time. This property is not required on a dedicated witness node.

``` text
---
title: "This property controls how many times a database connection is"
---
---
title: "reused before creating a new one. If set to zero, a new"
---
---
title: "connection will be created every time an agent pings its local"
---
---
title: "database."
---
db.reuse.connection.count=0
```

The `auto.failover` property enables automatic failover. By default, auto.failover is set to true.

``` text
---
title: "Whether or not failover will happen automatically when the master"
---
---
title: "fails. Set to false if you want to receive the failover notifications"
---
---
title: "but not have EFM actually perform the failover steps."
---
---
title: "The value of this property must be the same across all agents."
---
auto.failover=true
```

<div class="index">

auto.reconfigure

</div>

Use the `auto.reconfigure` property to instruct Failover Manager to enable or disable automatic reconfiguration of remaining Standby servers after the primary standby is promoted to Master. Set the property to `true` to enable automatic reconfiguration (the default) or `false` to disable automatic reconfiguration. This property is not required on a dedicated witness node. If you are using Advanced Server or PostgreSQL version 11 or earlier, the `recovery.conf` file will be backed up during the reconfiguration process.

``` text
---
title: "After a standby is promoted, Failover Manager will attempt to"
---
---
title: "update the remaining standbys to use the new master. For database"
---
---
title: "versions before 12, Failover Manager will back up recovery.conf."
---
---
title: "Then it will change the host parameter of the primary_conninfo entry"
---
---
title: "in recovery.conf or postgresql.auto.conf, and restart the database. The"
---
---
title: "restart command is contained in either the efm_db_functions or"
---
---
title: "efm_root_functions file; default when not running db as an os"
---
---
title: "service is: "pg_ctl restart -m fast -w -t <timeout> -D <directory>""
---
---
title: "where the timeout is the local.timeout property value and the"
---
---
title: "directory is specified by db.data.dir. To turn off"
---
---
title: "automatic reconfiguration, set this property to false."
---
auto.reconfigure=true
```

Please note: `primary_conninfo` is a space-delimited list of keyword=value pairs.

Please note: If you are using replication slots to manage your WAL segments, automatic reconfiguration is not supported; you should set `auto.reconfigure` to `false`. In the event of a failover, you must manually reconfigure the standby servers.

<div class="index">

promotable

</div>

Use the `promotable` property to indicate that a node should not be promoted. To override the setting, use the efm set-priority command at runtime; for more information about the efm set-priority command, see `Using the efm Utility <using_efm_utility>`.

``` text
---
title: "A standby with this set to false will not be added to the"
---
---
title: "failover priority list, and so will not be available for"
---
---
title: "promotion. The property will be used whenever an agent starts"
---
---
title: "as a standby or resumes as a standby after being idle. After"
---
---
title: "startup/resume, the node can still be added or removed from the"
---
---
title: "priority list with the 'efm set-priority' command. This"
---
---
title: "property is required for all non-witness nodes."
---
promotable=true
```

If the same amount of data has been written to more than one standby node, and a failover occurs, the use.replay.tiebreaker value will determine how Failover Manager selects a replacement master. Set the `use.replay.tiebreaker` property to `true` to instruct Failover Manager to failover to the node that will come out of recovery faster, as determined by the log sequence number. To ignore the log sequence number and promote a node based on user preference, set `use.replay.tiebreaker` to `false`.

> \# Use replay LSN value for tiebreaker when choosing a standby to promote \# before using failover priority. Set this property to true to consider \# replay location as more important than failover priority (as seen in \# cluster-status command) when choosing the "most ahead" standby to promote. use.replay.tiebreaker=true

You can use the `application.name` property to provide the name of an application that will be copied to the `primary_conninfo` parameter before restarting an old master node as a standby.

``` text
---
title: "During a switchover, recovery settings are copied from a standby"
---
---
title: "to the original master. If the application.name property is set,"
---
---
title: "Failover Manager will replace the application_name portion of the"
---
---
title: "primary_conninfo entry with this property value before starting"
---
---
title: "the original master database as a standby. If this property is"
---
---
title: "not set, Failover Manager will remove the parameter value"
---
---
title: "from primary_conninfo."
---
application.name=
```

**Please note:** You should set the `application.name` property on the master and any promotable standby; in the event of a failover/switchover, the master node could potentially become a standby node again.

Use the `restore.command` property to instruct Failover Manager to update the `restore_command` when a new master is promoted. `%h` represents the address of the new master; Failover Manager will replace `%h` with the address of the new master. `%f` and `%p` are placeholders used by the server. If the property is left blank, Failover Manager will not update the `restore_command` values on the standbys after a promotion.

See the PostgreSQL documentation for more information about using a [restore_command](https://www.postgresql.org/docs/12/runtime-config-wal.html#RUNTIME-CONFIG-WAL-ARCHIVE-RECOVERY).

``` text
---
title: "If the restore_command on a standby restores directly from the master node, use this property"
---
---
title: "to have Failover Manager change the command when a new master is promoted."
---
#
---
title: "Use the %h placeholder to represent the address of the new master. During promotion"
---
---
title: "it will be replaced with the address of the new master."
---
#
---
title: "If not specified, failover manager will not change the restore_command value, if any,"
---
---
title: "on standby nodes."
---
#
---
title: "Example:"
---
---
title: "restore.command=scp <db service owner>@%h:/var/lib/edb/as12/data/archive/%f %p"
---
restore.command=
```

The synchronous_standby_names parameter on the master node specifies the names and count of the synchronous standby servers that will confirm receipt of data, to ensure that the master nodes can accept write transactions. When set to true, Failover Manager will reduce the number of synchronous standby servers and reload the configuration of the master node to reflect the current value.

> \# Reduce num_sync when the number of synchronous standbys drops below the \# value required by the master database. If set to true, Failover Manager will \# reduce the number of standbys needed in the master's \# synchronous_standby_names property and reload the master configuration. \# Failover Manager will not reduce the number below 1, taking the master \# out of synchronous replication, unless the reconfigure.sync.master \# property is also set to true. reconfigure.num.sync=false

Set the `reconfigure.sync.master` property to `true` to take the master database out of synchronous replication mode if the number of standby nodes drops below the level required. Set `reconfigure.sync.master` to `false` to send a notification if the standby count drops, but not interrupt synchronous replication.

``` text
---
title: "Take the master database out of synchronous replication mode when needed."
---
---
title: "If set to true, Failover Manager will clear the synchronous_standby_names"
---
---
title: "configuration parameter on the master if the number of synchronous"
---
---
title: "standbys drops below the required level for the master to accept writes."
---
---
title: "If set to false, Failover Manager will detect the situation but will only"
---
---
title: "send a notification if the standby count drops below the required level."
---
#
---
title: "CAUTION: TAKING THE MASTER DATABASE OUT OF SYNCHRONOUS MODE MEANS THERE"
---
---
title: "MAY ONLY BE ONE COPY OF DATA. DO NOT MAKE THIS CHANGE UNLESS YOU ARE SURE"
---
---
title: "THIS IS OK."
---
reconfigure.sync.master=false
```

<div class="index">

minimum.standbys

</div>

Use the `minimum.standbys` property to specify the minimum number of standby nodes that will be retained on a cluster; if the standby count drops to the specified minimum, a replica node will not be promoted in the event of a failure of the master node.

``` text
---
title: "Instead of setting specific standbys as being unavailable for"
---
---
title: "promotion, this property can be used to set a minimum number"
---
---
title: "of standbys that will not be promoted. Set to one, for"
---
---
title: "example, promotion will not happen if it will drop the number"
---
---
title: "of standbys below this value. This property must be the same on"
---
---
title: "each node."
---
minimum.standbys=0
```

<div class="index">

recovery.check.period

</div>

Use the `recovery.check.period` property to specify the number of seconds that Failover Manager will wait before checks to see if a database is out of recovery.

``` text
---
title: "Time in seconds between checks to see if a promoting database"
---
---
title: "is out of recovery."
---
recovery.check.period=2
```

Use the `restart.connection.timeout` property to specify the number of seconds that Failover Manager will attempt to connect to a newly reconfigured master or standby node while the database on that node prepares to accept connections.

``` text
---
title: "Time in seconds to keep trying to connect to a database after a"
---
---
title: "start or restart command returns successfully but the database"
---
---
title: "is not ready to accept connections yet (a rare occurance). This"
---
---
title: "applies to standby databases that are restarted when being"
---
---
title: "reconfigured for a new master, and to master databases that"
---
---
title: "are stopped and started as standbys during a switchover."
---
---
title: "This retry mechanism is unrelated to the auto.resume.period parameter."
---
restart.connection.timeout=60
```

<div class="index">

auto.resume.period

</div>

Use the `auto.resume.period` property to specify the number of seconds (after a monitored database fails, and an agent has assumed an idle state, or when starting in IDLE mode) during which an agent will attempt to resume monitoring that database.

``` text
---
title: "Period in seconds for IDLE agents to try to resume monitoring"
---
---
title: "after a database failure or when starting in IDLE mode. Set to"
---
---
title: "0 for agents to not try to resume (in which case the"
---
---
title: "'efm resume <cluster>' command is used after bringing a"
---
---
title: "database back up)."
---
auto.resume.period=0
```

Failover Manager provides support for clusters that use a virtual IP. If your cluster uses a virtual IP, provide the host name or IP address in the `virtual.ip` property; specify the corresponding prefix in the `virtual.ip.prefix` property. If `virtual.ip` is left blank, virtual IP support is disabled.

Use the `virtual.ip.interface` property to provide the network interface used by the VIP.

The specified virtual IP address is assigned only to the master node of the cluster. If you specify `virtual.ip.single=true`, the same VIP address will be used on the new master in the event of a failover. Specify a value of false to provide a unique IP address for each node of the cluster.

For information about using a virtual IP address, see `Using Failover Manager with Virtual IP Addresses <using_vip_addresses>`.

``` text
---
title: "These properties specify the IP and prefix length that will be"
---
---
title: "remapped during failover. If you do not use a VIP as part of"
---
---
title: "your failover solution, leave the virtual.ip property blank to"
---
---
title: "disable Failover Manager support for VIP processing (assigning,"
---
---
title: "releasing, testing reachability, etc)."
---
#
---
title: "If you specify a VIP, the interface and prefix are required."
---
#
---
title: "If you specify a host name, it will be resolved to an IP address"
---
---
title: "when acquiring or releasing the VIP. If the host name resolves"
---
---
title: "to more than one IP address, there is no way to predict which"
---
---
title: "address Failover Manager will use."
---
#
---
title: "By default, the virtual.ip and virtual.ip.prefix values must be"
---
---
title: "the same across all agents. If you set virtual.ip.single to"
---
---
title: "false, you can specify unique values for virtual.ip and"
---
---
title: "virtual.ip.prefix on each node."
---
#
---
title: "If you are using an IPv4 address, the virtual.ip.interface value"
---
---
title: "should not contain a secondary virtual ip id (do not include"
---
---
title: "":1", etc)."
---
virtual.ip=
virtual.ip.interface=
virtual.ip.prefix=
virtual.ip.single=true
```

Please Note: If a master agent is started and the node does not currently have the VIP, the EFM agent will acquire it. Stopping a master agent does not drop the VIP from the node.

Set the `check.vip.before.promotion` property to false to indicate that Failover Manager will not check to see if a VIP is in use before assigning it to a a new master in the event of a failure. Please note that this could result in multiple nodes broadcasting on the same VIP address; unless the master node is isolated or can be shut down via another process, you should set this property to true.

``` text
---
title: "Whether to check if the VIP (when used) is still in use before"
---
---
title: "promoting after a master failure. Turning this off may allow"
---
---
title: "the new master to have the VIP even though another node is also"
---
---
title: "broadcasting it. This should only be used in environments where"
---
---
title: "it is known that the failed master node will be isolated or"
---
---
title: "shut down through other means."
---
check.vip.before.promotion=true
```

Use the following properties to provide paths to scripts that reconfigure your load balancer in the event of a switchover or master failure scenario. The scripts will also be invoked in the event of a standby failure. If you are using these properties, they should be provided on every node of the cluster (master, standby, and witness) to ensure that if a database node fails, another node will call the detach script with the failed node's address.

Provide a script name after the `script.load.balancer.attach` property to identify a script that will be invoked when a node should be attached to the load balancer. Use the `script.load.balancer.detach` property to specify the name of a script that will be invoked when a node should be detached from the load balancer. Include the `%h` placeholder to represent the IP address of the node that is being attached or removed from the cluster. Include the `%t` placeholder to instruct Failover Manager to include an m (for a master node) or an s (for a standby node) in the string.

``` text
---
title: "Absolute path to load balancer scripts"
---
---
title: "The attach script is called when a node should be attached to"
---
---
title: "the load balancer, for example after a promotion. The detach"
---
---
title: "script is called when a node should be removed, for example"
---
---
title: "when a database has failed or is about to be stopped. Use %h to"
---
---
title: "represent the IP/hostname of the node that is being"
---
---
title: "attached/detached. Use %t to represent the type of node being"
---
---
title: "attached or detached: the letter m will be passed in for master nodes"
---
#and the letter s for standby nodes.
#
---
title: "Example:"
---
---
title: "script.load.balancer.attach=/somepath/attachscript %h %t"
---
script.load.balancer.attach=
script.load.balancer.detach=
```

`script.fence` specifies the path to an optional user-supplied script that will be invoked during the promotion of a standby node to master node.

``` text
---
title: "absolute path to fencing script run during promotion"
---
#
---
title: "This is an optional user-supplied script that will be run"
---
---
title: "during failover on the standby database node. If left blank,"
---
---
title: "no action will be taken. If specified, EFM will execute this"
---
---
title: "script before promoting the standby."
---
#
---
title: "Parameters can be passed into this script for the failed master"
---
---
title: "and new primary node addresses. Use %p for new primary and %f"
---
---
title: "for failed master. On a node that has just been promoted, %p"
---
---
title: "should be the same as the node's efm binding address."
---
#
---
title: "Example:"
---
---
title: "script.fence=/somepath/myscript %p %f"
---
#
---
title: "NOTE: FAILOVER WILL NOT OCCUR IF THIS SCRIPT RETURNS A NON-ZERO EXIT CODE."
---
script.fence=
```

<div class="index">

script.post.promotion

</div>

Use the `script.post.promotion` property to specify the path to an optional user-supplied script that will be invoked after a standby node has been promoted to master.

``` text
---
title: "Absolute path to fencing script run after promotion"
---
#
---
title: "This is an optional user-supplied script that will be run after"
---
---
title: "failover on the standby node after it has been promoted and"
---
---
title: "is no longer in recovery. The exit code from this script has"
---
---
title: "no effect on failover manager, but will be included in a"
---
---
title: "notification sent after the script executes."
---
#
---
title: "Parameters can be passed into this script for the failed master"
---
---
title: "and new primary node addresses. Use %p for new primary and %f"
---
---
title: "for failed master. On a node that has just been promoted, %p"
---
---
title: "should be the same as the node's efm binding address."
---
#
---
title: "Example:"
---
---
title: "script.post.promotion=/somepath/myscript %f %p"
---
script.post.promotion=
```

<div class="index">

script.resumed

</div>

Use the `script.resumed property` to specify an optional path to a user-supplied script that will be invoked when an agent resumes monitoring of a database.

``` text
---
title: "Absolute path to resume script"
---
#
---
title: "This script is run before an IDLE agent resumes"
---
---
title: "monitoring its local database."
---
script.resumed=
```

<div class="index">

script.db.failure

</div>

Use the `script.db.failure` property to specify the complete path to an optional user-supplied script that Failover Manager will invoke if an agent detects that the database that it monitors has failed.

``` text
---
title: "Absolute path to script run after database failure"
---
---
title: "This is an optional user-supplied script that will be run after"
---
---
title: "an agent detects that its local database has failed."
---
script.db.failure=
```

<div class="index">

script.master.isolated

</div>

Use the `script.master.isolated` property to specify the complete path to an optional user-supplied script that Failover Manager will invoke if the agent monitoring the master database detects that the master is isolated from the majority of the Failover Manager cluster. This script is called immediately after the VIP is released (if a VIP is in use).

``` text
---
title: "Absolute path to script run on isolated master"
---
---
title: "This is an optional user-supplied script that will be run after"
---
---
title: "a master agent detects that it has been isolated from the"
---
---
title: "majority of the efm cluster."
---
script.master.isolated=
```

<div class="index">

script.remote.pre.promotion

</div>

Use the `script.remote.pre.promotion` property to specify the path and name of a script that will be invoked on any agent nodes not involved in the promotion when a node is about to promote its database to master.

Include the %p placeholder to identify the address of the new primary node.

``` text
---
title: "Absolute path to script invoked on non-promoting agent nodes"
---
---
title: "before a promotion."
---
#
---
title: "This optional user-supplied script will be invoked on other"
---
---
title: "agents when a node is about to promote its database. The exit"
---
---
title: "code from this script has no effect on Failover Manager, but"
---
---
title: "will be included in a notification sent after the script"
---
---
title: "executes."
---
#
---
title: "Pass a parameter (%p) with the script to identify the new"
---
---
title: "primary node address."
---
#
---
title: "Example:"
---
---
title: "script.remote.pre.promotion=/path_name/script_name %p"
---
script.remote.pre.promotion=
```

<div class="index">

script.remote.post.promotion

</div>

Use the `script.remote.post.promotion` property to specify the path and name of a script that will be invoked on any non-master nodes after a promotion occurs.

Include the %p placeholder to identify the address of the new primary node.

``` text
---
title: "Absolute path to script invoked on non-master agent nodes"
---
---
title: "after a promotion."
---
#
---
title: "This optional user-supplied script will be invoked on nodes"
---
---
title: "(except the new master) after a promotion occurs. The exit code"
---
---
title: "from this script has no effect on Failover Manager, but will be"
---
---
title: "included in a notification sent after the script executes."
---
#
---
title: "Pass a parameter (%p) with the script to identify the new"
---
---
title: "primary node address."
---
#
---
title: "Example:"
---
---
title: "script.remote.post.promotion=/path_name/script_name %p"
---
script.remote.post.promotion=
```

<div class="index">

script.custom.monitor custom.monitor.interval custom.monitor.timeout custom.monitor.safe.mode

</div>

Use the `script.custom.monitor` property to provide the name and location of an optional script that will be invoked on regular intervals (specified in seconds by the `custom.monitor.interval` property).

Use `custom.monitor.timeout` to specify the maximum time that the script will be allowed to run; if script execution does not complete within the time specified, Failover Manager will send a notification.

Set `custom.monitor.safe.mode` to true to instruct Failover Manager to report non-zero exit codes from the script, but not promote a standby as a result of an exit code.

``` text
---
title: "Absolute path to a custom monitoring script."
---
#
---
title: "Use script.custom.monitor to specify the location and name of"
---
---
title: "an optional user-supplied script that will be invoked"
---
---
title: "periodically to perform custom monitoring tasks. A non-zero"
---
---
title: "exit value means that a check has failed; this will be treated"
---
---
title: "as a database failure. On a master node, script failure will"
---
---
title: "cause a promotion. On a standby node script failure will"
---
---
title: "generate a notification and the agent will become IDLE."
---
#
---
title: "The custom.monitor.* properties are required if a custom"
---
---
title: "monitoring script is specified:"
---
#
---
title: "custom.monitor.interval is the time in seconds between executions of the script."
---
#
---
title: "custom.monitor.timeout is a timeout value in seconds for how"
---
---
title: "long the script will be allowed to run. If script execution"
---
---
title: "exceeds the specified time, the task will be stopped and a"
---
---
title: "notification sent. Subsequent runs will continue."
---
#
---
title: "If custom.monitor.safe.mode is set to true, non-zero exit codes"
---
---
title: "from the script will be reported but will not cause a promotion"
---
---
title: "or be treated as a database failure. This allows testing of the"
---
---
title: "script without affecting EFM."
---
#
script.custom.monitor=
custom.monitor.interval=
custom.monitor.timeout=
custom.monitor.safe.mode=
```

<div class="index">

sudo.command sudo.user.command

</div>

Use the `sudo.command` property to specify a command that will be invoked by Failover Manager when performing tasks that require extended permissions. Use this option to include command options that might be specific to your system authentication.

Use the `sudo.user.command` property to specify a command that will be invoked by Failover Manager when executing commands that will be performed by the database owner.

``` text
---
title: "Command to use in place of 'sudo' if desired when efm runs"
---
---
title: "the efm_db_functions or efm_root_functions, or efm_address"
---
---
title: "scripts."
---
---
title: "Sudo is used in the following ways by efm:"
---
#
---
title: "sudo /usr/edb/efm-<version>/bin/efm_address <arguments>"
---
---
title: "sudo /usr/edb/efm-<version>/bin/efm_root_functions <arguments>"
---
---
title: "sudo -u <db service owner> /usr/edb/efm-<version>/bin/efm_db_functions <arguments>"
---
#
---
title: "'sudo' in the first two examples will be replaced by the value"
---
---
title: "of the sudo.command property. 'sudo -u <db service owner>' will"
---
---
title: "be replaced by the value of the sudo.user.command property."
---
---
title: "The '%u' field will be replaced with the db owner."
---
sudo.command=sudo
sudo.user.command=sudo -u %u
```

<div class="index">

lock.dir

</div>

Use the `lock.dir` property to specify an alternate location for the Failover Manager lock file; the file prevents Failover Manager from starting multiple (potentially orphaned) agents for a single cluster on the node.

``` text
---
title: "Specify the directory of lock file on the node. Failover"
---
---
title: "Manager creates a file named <cluster>.lock at this location to"
---
---
title: "avoid starting multiple agents for same cluster. If the path"
---
---
title: "does not exist, Failover Manager will attempt to create it. If"
---
---
title: "not specified defaults to '/var/lock/efm-<version>'"
---
lock.dir=
```

Use the `log.dir` property to specify the location to which agent log files will be written; Failover Manager will attempt to create the directory if the directory does not exist.

``` text
---
title: "Specify the directory of agent logs on the node. If the path"
---
---
title: "does not exist, Failover Manager will attempt to create it. If"
---
---
title: "not specified defaults to '/var/log/efm-<version>'. (To store"
---
---
title: "Failover Manager startup logs in a custom location, modify the"
---
---
title: "path in the service script to point to an existing, writable"
---
---
title: "directory.)"
---
---
title: "If using a custom log directory, you must configure"
---
---
title: "logrotate separately. Use 'man logrotate' for more information."
---
log.dir=
```

After enabling the UDP or TCP protocol on a Failover Manager host, you can enable logging to syslog. Use the `syslog.protocol` parameter to specify the protocol type (UDP or TCP) and the `syslog.port` parameter to specify the listener port of the syslog host. The `syslog.facility` value may be used as an identifier for the process that created the entry; the value must be between LOCAL0 and LOCAL7.

``` text
---
title: "Syslog information. The syslog service must be listening on"
---
---
title: "the port for the given protocol, which can be UDP or TCP."
---
---
title: "The facilities supported are LOCAL0 through LOCAL7."
---
syslog.host=localhost
syslog.port=514
syslog.protocol=UDP
syslog.facility=LOCAL1
```

Use the `file.log.enabled` and `syslog.enabled` properties to specify the type of logging that you wish to implement. Set file.log.enabled to true to enable logging to a file; enable the UDP protocol or TCP protocol and set syslog.enabled to true to enable logging to syslog. You can enable logging to both a file and syslog.

``` text
---
title: "Which logging is enabled."
---
file.log.enabled=true
syslog.enabled=false
```

For more information about configuring syslog logging, see

[Enabling syslog Log File Entries](enabling_syslog) .

Use the `jgroups.loglevel` and `efm.loglevel` parameters to specify the level of detail logged by Failover Manager. The default value is INFO. For more information about logging, see `Controlling Logging <controlling_logging>` .

``` text
---
title: "Logging levels for JGroups and EFM."
---
---
title: "Valid values are: TRACE, DEBUG, INFO, WARN, ERROR"
---
---
title: "Default value: INFO"
---
---
title: "It is not necessary to increase these values unless debugging a"
---
---
title: "specific issue. If nodes are not discovering each other at"
---
---
title: "startup, increasing the jgroups level to DEBUG will show"
---
---
title: "information about the TCP connection attempts that may help"
---
---
title: "diagnose the connection failures."
---
jgroups.loglevel=INFO
efm.loglevel=INFO
```

<div class="index">

jvm.options

</div>

Use the `jvm.options` property to pass JVM-related configuration information. The default setting specifies the amount of memory that the Failover Manager agent will be allowed to use.

``` text
---
title: "Extra information that will be passed to the JVM when starting"
---
---
title: "the agent."
---
jvm.options=-Xmx128m
```

<div class="toctree" data-maxdepth="3">

encrypting_database_password

</div>
