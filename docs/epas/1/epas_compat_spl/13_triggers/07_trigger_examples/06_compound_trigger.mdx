---
title: "Compound Triggers"
---

The following example of a compound trigger records a change to the employee salary by defining a compound trigger (named `HR_TRIGGER`) on the `EMP` table.

First, create a table named `EMP`:

``` text
CREATE TABLE EMP(EMPNO INT, ENAME TEXT, SAL INT, DEPTNO INT);
CREATE TABLE
```

Then, create a compound trigger (`HR_TRIGGER`). The trigger is created for each of the four timing-points to `INSERT, UPDATE`, and `DELETE` salary in the `EMP` table. In the global declaration section, the salary is declared as 10,000.

``` text
CREATE OR REPLACE TRIGGER HR_TRIGGER
  FOR INSERT OR UPDATE OR DELETE ON EMP
    COMPOUND TRIGGER
  -- Global declaration.
  var_sal NUMBER := 10000;

  BEFORE STATEMENT IS
  BEGIN
    var_sal := var_sal + 1000;
    DBMS_OUTPUT.PUT_LINE('Before Statement: ' || var_sal);
  END BEFORE STATEMENT;

  BEFORE EACH ROW IS
  BEGIN
    var_sal := var_sal + 1000;
    DBMS_OUTPUT.PUT_LINE('Before Each Row: ' || var_sal);
  END BEFORE EACH ROW;

  AFTER EACH ROW IS
  BEGIN
    var_sal := var_sal + 1000;
    DBMS_OUTPUT.PUT_LINE('After Each Row: ' || var_sal);
  END AFTER EACH ROW;

  AFTER STATEMENT IS
  BEGIN
    var_sal := var_sal + 1000;
    DBMS_OUTPUT.PUT_LINE('After Statement: ' || var_sal);
  END AFTER STATEMENT;

END HR_TRIGGER;

Output: Trigger created.
```

Insert a record into the `EMP` table:

``` text
INSERT INTO EMP(EMPNO, ENAME, SAL, DEPTNO) VALUES(1111,'SMITH', 10000, 20);
```

The insert statement produces the following output:

``` text
Before Statement: 11000
Before each row: 12000
After each row: 13000
After statement: 14000
INSERT 0 1
```

The following `UPDATE` statement will update the employee salary record (where a salary is set to 15000) for a specific employee number.

``` text
UPDATE EMP SET SAL = 15000 where EMPNO = 1111;
```

The `UPDATE` statement produces the following output:

``` text
Before Statement: 11000
Before each row: 12000
After each row: 13000
After statement: 14000
UPDATE 1

SELECT * from EMP;
 EMPNO | ENAME |  SAL  | DEPTNO
-------+-------+-------+--------
  1111 | SMITH | 15000 |     20
(1 row)
```

The `DELETE` statement deletes the employee salary record.

``` text
DELETE from EMP where EMPNO = 1111;
```

The `DELETE` statement produces the following output:

``` text
Before Statement: 11000
Before each row: 12000
After each row: 13000
After statement: 14000
DELETE 1

SELECT * from EMP;
 EMPNO | ENAME | SAL | DEPTNO
-------+-------+-----+--------
(0 rows)
```

A `TRUNCATE` statement removes all the records from the `EMP` table.

``` text
CREATE OR REPLACE TRIGGER HR_TRIGGER
  FOR TRUNCATE ON EMP
    COMPOUND TRIGGER
  -- Global declaration.
  var_sal NUMBER := 10000;
  BEFORE STATEMENT IS
  BEGIN
    var_sal := var_sal + 1000;
    DBMS_OUTPUT.PUT_LINE('Before Statement: ' || var_sal);
  END BEFORE STATEMENT;

  AFTER STATEMENT IS
  BEGIN
    var_sal := var_sal + 1000;
    DBMS_OUTPUT.PUT_LINE('After Statement: ' || var_sal);
  END AFTER STATEMENT;

END HR_TRIGGER;

Output: Trigger created.
```

The `TRUNCATE` statement produces the following output:

``` text
TRUNCATE EMP;
Before Statement: 11000
After statement: 12000
TRUNCATE TABLE
```

<div class="note">

<div class="title">

Note

</div>

The `TRUNCATE` statement supports `BEFORE STATEMENT, AFTER STATEMENT` timing-point only.

</div>
